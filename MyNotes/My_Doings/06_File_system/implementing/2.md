‚úÖ 1. editorContent ‚Üí DELETE ownership

Right now:

editorContent: ""

This is your biggest architectural smell.

Because editor content already exists inside files.

So you have:

openFiles.content
editorContent

Two truths.

After Refactor

üö® Zustand should NOT store editor content.

Instead:

editor reads ‚Üí FileManager.read(activeFileId)

So:

‚úÖ remove gradually
(not instantly ‚Äî we migrate)

### 2. updateFileContent ‚Üí MOVE LOGIC

Currently:

openFiles.map(...)
hasUnsavedChanges
originalContent comparison

THIS is filesystem logic.

So this moves into:

fileManager.updateFile(fileId, content)
New Zustand version becomes:
updateFileContent(fileId, content) {
   fileManager.updateFile(fileId, content)
}

Zustand delegates.

Ownership transferred ‚úÖ

### 3. openFile() ‚Üí SPLIT RESPONSIBILITY

Right now it does:

UI work ‚úÖ
    activate tab
    add openFiles entry

Data work ‚ùå
    store content
    store originalContent

After Refactor

When opening:

fileManager.registerFile(
   fileId,
   file.content ?? ""
)

Then Zustand only tracks:

openFiles: [{ id, filename }]
activeFileId

NO CONTENT.

### 4. closeFile() ‚Üí MUCH SIMPLER

Currently:

newEditorContent = lastFile.content

After refactor:

You DON'T CARE about content.
Editor derives automatically.

So:

closeFile(fileId) {
   set({
     openFiles: filtered,
     activeFileId: nextId
   })

   fileManager.unregister(fileId)
}

Done.

### 5. closeAllFiles()

No change except:

fileManager.clear()


### What Zustand Will Look Like After Step B

Zustand becomes:

{
  openFiles: [
     { id, filename, extension }
  ],

  activeFileId: string | null
}

ONLY UI STATE.


### The Mental Flip (Important)

Before:

Editor ‚Üê Zustand ‚Üê File Content

After:

Editor ‚Üê FileManager
           ‚Üë
        Zustand (which file?)

Zustand answers:
WHICH file?

FileManager answers:
WHAT is inside file?


‚ö° Golden Rule

If you ever see this inside Zustand again:

content
originalContent
isDirty

You regressed architecture.

### Correct Order To Implement (VERY IMPORTANT)

Do NOT delete things first.

Follow this exact order:

STEP 1 ‚úÖ Create FileManager class

(no integration yet)

STEP 2 ‚úÖ Make updateFileContent

call FileManager AND old logic.

Temporary duplication allowed.

STEP 3 ‚úÖ Editor reads from FileManager

Now editor no longer depends on editorContent.

STEP 4 ‚úÖ Delete editorContent safely
STEP 5 ‚úÖ Remove content from openFiles

Final cleanup.